{"ast":null,"code":"import { graphQLOperationsInfo } from '../APIClient.mjs';\nimport { listFactory } from '../operations/list.mjs';\nimport { indexQueryFactory } from '../operations/indexQuery.mjs';\nimport { getFactory } from '../operations/get.mjs';\nimport { getSecondaryIndexesFromSchemaModel } from '../clientUtils.mjs';\nfunction generateModelsProperty(client, params) {\n  var _config$API;\n  const models = {};\n  const config = params.config;\n  const useContext = params.amplify === null;\n  if (!config) {\n    throw new Error('generateModelsProperty cannot retrieve Amplify config');\n  }\n  if (!((_config$API = config.API) !== null && _config$API !== void 0 && _config$API.GraphQL)) {\n    return {};\n  }\n  const modelIntrospection = config.API.GraphQL.modelIntrospection;\n  if (!modelIntrospection) {\n    return {};\n  }\n  const SSR_UNSUPORTED_OPS = ['ONCREATE', 'ONUPDATE', 'ONDELETE', 'OBSERVE_QUERY'];\n  for (const model of Object.values(modelIntrospection.models)) {\n    const {\n      name\n    } = model;\n    models[name] = {};\n    Object.entries(graphQLOperationsInfo).forEach(_ref => {\n      let [key, {\n        operationPrefix\n      }] = _ref;\n      const operation = key;\n      // subscriptions are not supported in SSR\n      if (SSR_UNSUPORTED_OPS.includes(operation)) return;\n      if (operation === 'LIST') {\n        models[name][operationPrefix] = listFactory(client, modelIntrospection, model, useContext);\n      } else {\n        models[name][operationPrefix] = getFactory(client, modelIntrospection, model, operation, useContext);\n      }\n    });\n    const secondaryIdxs = getSecondaryIndexesFromSchemaModel(model);\n    for (const idx of secondaryIdxs) {\n      models[name][idx.queryField] = indexQueryFactory(client, modelIntrospection, model, idx);\n    }\n  }\n  return models;\n}\nexport { generateModelsProperty };","map":{"version":3,"names":["generateModelsProperty","client","params","_config$API","models","config","useContext","amplify","Error","API","GraphQL","modelIntrospection","SSR_UNSUPORTED_OPS","model","Object","values","name","entries","graphQLOperationsInfo","forEach","_ref","key","operationPrefix","operation","includes","listFactory","getFactory","secondaryIdxs","getSecondaryIndexesFromSchemaModel","idx","queryField","indexQueryFactory"],"sources":["/Users/raphaperso/Documents/Hub/amplify_test/notes/node_modules/@aws-amplify/api-graphql/src/internals/server/generateModelsProperty.ts"],"sourcesContent":["import { graphQLOperationsInfo } from '../APIClient';\nimport { listFactory } from '../operations/list';\nimport { indexQueryFactory } from '../operations/indexQuery';\nimport { getFactory } from '../operations/get';\nimport { getSecondaryIndexesFromSchemaModel } from '../clientUtils';\nexport function generateModelsProperty(client, params) {\n    const models = {};\n    const config = params.config;\n    const useContext = params.amplify === null;\n    if (!config) {\n        throw new Error('generateModelsProperty cannot retrieve Amplify config');\n    }\n    if (!config.API?.GraphQL) {\n        return {};\n    }\n    const modelIntrospection = config.API.GraphQL.modelIntrospection;\n    if (!modelIntrospection) {\n        return {};\n    }\n    const SSR_UNSUPORTED_OPS = [\n        'ONCREATE',\n        'ONUPDATE',\n        'ONDELETE',\n        'OBSERVE_QUERY',\n    ];\n    for (const model of Object.values(modelIntrospection.models)) {\n        const { name } = model;\n        models[name] = {};\n        Object.entries(graphQLOperationsInfo).forEach(([key, { operationPrefix }]) => {\n            const operation = key;\n            // subscriptions are not supported in SSR\n            if (SSR_UNSUPORTED_OPS.includes(operation))\n                return;\n            if (operation === 'LIST') {\n                models[name][operationPrefix] = listFactory(client, modelIntrospection, model, useContext);\n            }\n            else {\n                models[name][operationPrefix] = getFactory(client, modelIntrospection, model, operation, useContext);\n            }\n        });\n        const secondaryIdxs = getSecondaryIndexesFromSchemaModel(model);\n        for (const idx of secondaryIdxs) {\n            models[name][idx.queryField] = indexQueryFactory(client, modelIntrospection, model, idx);\n        }\n    }\n    return models;\n}\n"],"mappings":";;;;;AAKO,SAASA,sBAAsBA,CAACC,MAAM,EAAEC,MAAM,EAAE;EAAA,IAAAC,WAAA;EACnD,MAAMC,MAAM,GAAG,EAAE;EACjB,MAAMC,MAAM,GAAGH,MAAM,CAACG,MAAM;EAC5B,MAAMC,UAAU,GAAGJ,MAAM,CAACK,OAAO,KAAK,IAAI;EAC1C,IAAI,CAACF,MAAM,EAAE;IACT,MAAM,IAAIG,KAAK,CAAC,uDAAuD,CAAC;EAChF;EACI,IAAI,GAAAL,WAAA,GAACE,MAAM,CAACI,GAAG,cAAAN,WAAA,eAAVA,WAAA,CAAYO,OAAO,GAAE;IACtB,OAAO,EAAE;EACjB;EACI,MAAMC,kBAAkB,GAAGN,MAAM,CAACI,GAAG,CAACC,OAAO,CAACC,kBAAkB;EAChE,IAAI,CAACA,kBAAkB,EAAE;IACrB,OAAO,EAAE;EACjB;EACI,MAAMC,kBAAkB,GAAG,CACvB,UAAU,EACV,UAAU,EACV,UAAU,EACV,eAAe,CAClB;EACD,KAAK,MAAMC,KAAK,IAAIC,MAAM,CAACC,MAAM,CAACJ,kBAAkB,CAACP,MAAM,CAAC,EAAE;IAC1D,MAAM;MAAEY;IAAI,CAAE,GAAGH,KAAK;IACtBT,MAAM,CAACY,IAAI,CAAC,GAAG,EAAE;IACjBF,MAAM,CAACG,OAAO,CAACC,qBAAqB,CAAC,CAACC,OAAO,CAACC,IAAA,IAAgC;MAAA,IAA/B,CAACC,GAAG,EAAE;QAAEC;MAAe,CAAE,CAAC,GAAAF,IAAA;MACrE,MAAMG,SAAS,GAAGF,GAAG;MACjC;MACY,IAAIT,kBAAkB,CAACY,QAAQ,CAACD,SAAS,CAAC,EACtC;MACJ,IAAIA,SAAS,KAAK,MAAM,EAAE;QACtBnB,MAAM,CAACY,IAAI,CAAC,CAACM,eAAe,CAAC,GAAGG,WAAW,CAACxB,MAAM,EAAEU,kBAAkB,EAAEE,KAAK,EAAEP,UAAU,CAAC;MAC1G,CAAa,MACI;QACDF,MAAM,CAACY,IAAI,CAAC,CAACM,eAAe,CAAC,GAAGI,UAAU,CAACzB,MAAM,EAAEU,kBAAkB,EAAEE,KAAK,EAAEU,SAAS,EAAEjB,UAAU,CAAC;MACpH;IACA,CAAS,CAAC;IACF,MAAMqB,aAAa,GAAGC,kCAAkC,CAACf,KAAK,CAAC;IAC/D,KAAK,MAAMgB,GAAG,IAAIF,aAAa,EAAE;MAC7BvB,MAAM,CAACY,IAAI,CAAC,CAACa,GAAG,CAACC,UAAU,CAAC,GAAGC,iBAAiB,CAAC9B,MAAM,EAAEU,kBAAkB,EAAEE,KAAK,EAAEgB,GAAG,CAAC;IACpG;EACA;EACI,OAAOzB,MAAM;AACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}