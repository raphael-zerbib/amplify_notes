{"ast":null,"code":"import { generateGraphQLDocument, buildGraphQLVariables, authModeParams, getCustomHeaders, flattenItems, initializeModel } from '../APIClient.mjs';\nfunction listFactory(client, modelIntrospection, model, context = false) {\n  const listWithContext = async (contextSpec, args) => {\n    return _list(client, modelIntrospection, model, args, contextSpec);\n  };\n  const list = async args => {\n    return _list(client, modelIntrospection, model, args);\n  };\n  return context ? listWithContext : list;\n}\nasync function _list(client, modelIntrospection, model, args, contextSpec) {\n  const {\n    name\n  } = model;\n  const query = generateGraphQLDocument(modelIntrospection, name, 'LIST', args);\n  const variables = buildGraphQLVariables(model, 'LIST', args, modelIntrospection);\n  try {\n    const auth = authModeParams(client, args);\n    const headers = getCustomHeaders(client, args?.headers);\n    const {\n      data,\n      extensions\n    } = !!contextSpec ? await client.graphql(contextSpec, {\n      ...auth,\n      query,\n      variables\n    }, headers) : await client.graphql({\n      ...auth,\n      query,\n      variables\n    }, headers);\n    // flatten response\n    if (data !== undefined) {\n      const [key] = Object.keys(data);\n      if (data[key].items) {\n        const flattenedResult = flattenItems(data)[key];\n        // don't init if custom selection set\n        if (args?.selectionSet) {\n          return {\n            data: flattenedResult,\n            nextToken: data[key].nextToken,\n            extensions\n          };\n        } else {\n          const initialized = initializeModel(client, name, flattenedResult, modelIntrospection, auth.authMode, auth.authToken, !!contextSpec);\n          return {\n            data: initialized,\n            nextToken: data[key].nextToken,\n            extensions\n          };\n        }\n      }\n      return {\n        data: data[key],\n        nextToken: data[key].nextToken,\n        extensions\n      };\n    }\n  } catch (error) {\n    if (error.errors) {\n      // graphql errors pass through\n      return error;\n    } else {\n      // non-graphql errors re re-thrown\n      throw error;\n    }\n  }\n}\nexport { listFactory };","map":{"version":3,"names":["listFactory","client","modelIntrospection","model","context","listWithContext","contextSpec","args","_list","list","name","query","generateGraphQLDocument","variables","buildGraphQLVariables","auth","authModeParams","headers","getCustomHeaders","data","extensions","graphql","undefined","key","Object","keys","items","flattenedResult","flattenItems","selectionSet","nextToken","initialized","initializeModel","authMode","authToken","error","errors"],"sources":["/Users/raphaperso/Documents/Hub/FreeCodeCamp/amplify_notes/node_modules/@aws-amplify/api-graphql/src/internals/operations/list.ts"],"sourcesContent":["import { initializeModel, generateGraphQLDocument, buildGraphQLVariables, flattenItems, authModeParams, getCustomHeaders, } from '../APIClient';\nexport function listFactory(client, modelIntrospection, model, context = false) {\n    const listWithContext = async (contextSpec, args) => {\n        return _list(client, modelIntrospection, model, args, contextSpec);\n    };\n    const list = async (args) => {\n        return _list(client, modelIntrospection, model, args);\n    };\n    return context ? listWithContext : list;\n}\nasync function _list(client, modelIntrospection, model, args, contextSpec) {\n    const { name } = model;\n    const query = generateGraphQLDocument(modelIntrospection, name, 'LIST', args);\n    const variables = buildGraphQLVariables(model, 'LIST', args, modelIntrospection);\n    try {\n        const auth = authModeParams(client, args);\n        const headers = getCustomHeaders(client, args?.headers);\n        const { data, extensions } = !!contextSpec\n            ? (await client.graphql(contextSpec, {\n                ...auth,\n                query,\n                variables,\n            }, headers))\n            : (await client.graphql({\n                ...auth,\n                query,\n                variables,\n            }, headers));\n        // flatten response\n        if (data !== undefined) {\n            const [key] = Object.keys(data);\n            if (data[key].items) {\n                const flattenedResult = flattenItems(data)[key];\n                // don't init if custom selection set\n                if (args?.selectionSet) {\n                    return {\n                        data: flattenedResult,\n                        nextToken: data[key].nextToken,\n                        extensions,\n                    };\n                }\n                else {\n                    const initialized = initializeModel(client, name, flattenedResult, modelIntrospection, auth.authMode, auth.authToken, !!contextSpec);\n                    return {\n                        data: initialized,\n                        nextToken: data[key].nextToken,\n                        extensions,\n                    };\n                }\n            }\n            return {\n                data: data[key],\n                nextToken: data[key].nextToken,\n                extensions,\n            };\n        }\n    }\n    catch (error) {\n        if (error.errors) {\n            // graphql errors pass through\n            return error;\n        }\n        else {\n            // non-graphql errors re re-thrown\n            throw error;\n        }\n    }\n}\n"],"mappings":";AACO,SAASA,WAAWA,CAACC,MAAM,EAAEC,kBAAkB,EAAEC,KAAK,EAAEC,OAAO,GAAG,KAAK,EAAE;EAC5E,MAAMC,eAAe,GAAG,MAAAA,CAAOC,WAAW,EAAEC,IAAI,KAAK;IACjD,OAAOC,KAAK,CAACP,MAAM,EAAEC,kBAAkB,EAAEC,KAAK,EAAEI,IAAI,EAAED,WAAW,CAAC;EAC1E,CAAK;EACD,MAAMG,IAAI,GAAG,MAAOF,IAAI,IAAK;IACzB,OAAOC,KAAK,CAACP,MAAM,EAAEC,kBAAkB,EAAEC,KAAK,EAAEI,IAAI,CAAC;EAC7D,CAAK;EACD,OAAOH,OAAO,GAAGC,eAAe,GAAGI,IAAI;AAC3C;AACA,eAAeD,KAAKA,CAACP,MAAM,EAAEC,kBAAkB,EAAEC,KAAK,EAAEI,IAAI,EAAED,WAAW,EAAE;EACvE,MAAM;IAAEI;EAAI,CAAE,GAAGP,KAAK;EACtB,MAAMQ,KAAK,GAAGC,uBAAuB,CAACV,kBAAkB,EAAEQ,IAAI,EAAE,MAAM,EAAEH,IAAI,CAAC;EAC7E,MAAMM,SAAS,GAAGC,qBAAqB,CAACX,KAAK,EAAE,MAAM,EAAEI,IAAI,EAAEL,kBAAkB,CAAC;EAChF,IAAI;IACA,MAAMa,IAAI,GAAGC,cAAc,CAACf,MAAM,EAAEM,IAAI,CAAC;IACzC,MAAMU,OAAO,GAAGC,gBAAgB,CAACjB,MAAM,EAAEM,IAAI,EAAEU,OAAO,CAAC;IACvD,MAAM;MAAEE,IAAI;MAAEC;IAAU,CAAE,GAAG,CAAC,CAACd,WAAW,GACnC,MAAML,MAAM,CAACoB,OAAO,CAACf,WAAW,EAAE;MACjC,GAAGS,IAAI;MACPJ,KAAK;MACLE;IAChB,CAAa,EAAEI,OAAO,CAAC,GACR,MAAMhB,MAAM,CAACoB,OAAO,CAAC;MACpB,GAAGN,IAAI;MACPJ,KAAK;MACLE;IAChB,CAAa,EAAEI,OAAO,CAAE;IACxB;IACQ,IAAIE,IAAI,KAAKG,SAAS,EAAE;MACpB,MAAM,CAACC,GAAG,CAAC,GAAGC,MAAM,CAACC,IAAI,CAACN,IAAI,CAAC;MAC/B,IAAIA,IAAI,CAACI,GAAG,CAAC,CAACG,KAAK,EAAE;QACjB,MAAMC,eAAe,GAAGC,YAAY,CAACT,IAAI,CAAC,CAACI,GAAG,CAAC;QAC/D;QACgB,IAAIhB,IAAI,EAAEsB,YAAY,EAAE;UACpB,OAAO;YACHV,IAAI,EAAEQ,eAAe;YACrBG,SAAS,EAAEX,IAAI,CAACI,GAAG,CAAC,CAACO,SAAS;YAC9BV;UACxB,CAAqB;QACrB,CAAiB,MACI;UACD,MAAMW,WAAW,GAAGC,eAAe,CAAC/B,MAAM,EAAES,IAAI,EAAEiB,eAAe,EAAEzB,kBAAkB,EAAEa,IAAI,CAACkB,QAAQ,EAAElB,IAAI,CAACmB,SAAS,EAAE,CAAC,CAAC5B,WAAW,CAAC;UACpI,OAAO;YACHa,IAAI,EAAEY,WAAW;YACjBD,SAAS,EAAEX,IAAI,CAACI,GAAG,CAAC,CAACO,SAAS;YAC9BV;UACxB,CAAqB;QACrB;MACA;MACY,OAAO;QACHD,IAAI,EAAEA,IAAI,CAACI,GAAG,CAAC;QACfO,SAAS,EAAEX,IAAI,CAACI,GAAG,CAAC,CAACO,SAAS;QAC9BV;MAChB,CAAa;IACb;EACA,CAAK,CACD,OAAOe,KAAK,EAAE;IACV,IAAIA,KAAK,CAACC,MAAM,EAAE;MAC1B;MACY,OAAOD,KAAK;IACxB,CAAS,MACI;MACb;MACY,MAAMA,KAAK;IACvB;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}