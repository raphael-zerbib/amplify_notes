{"ast":null,"code":"import { parseMetadata } from '@aws-amplify/core/internals/aws-client-utils';\nimport '../runtime/s3TransferHandler/fetch.mjs';\nimport { parser } from '../runtime/xmlParser/pureJs.mjs';\nimport '../runtime/s3TransferHandler/xhr.mjs';\nimport 'buffer';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst parseXmlError = async response => {\n  var _ref, _body$message;\n  if (!response || response.statusCode < 300) {\n    return;\n  }\n  const {\n    statusCode\n  } = response;\n  const body = await parseXmlBody(response);\n  const code = body !== null && body !== void 0 && body.Code ? body.Code : statusCode === 404 ? 'NotFound' : statusCode.toString();\n  const message = (_ref = (_body$message = body === null || body === void 0 ? void 0 : body.message) !== null && _body$message !== void 0 ? _body$message : body === null || body === void 0 ? void 0 : body.Message) !== null && _ref !== void 0 ? _ref : code;\n  const error = new Error(message);\n  return Object.assign(error, {\n    name: code,\n    $metadata: parseMetadata(response)\n  });\n};\nconst parseXmlBody = async response => {\n  if (!response.body) {\n    // S3 can return 200 without a body indicating failure.\n    throw new Error('S3 aborted request.');\n  }\n  const data = await response.body.text();\n  if ((data === null || data === void 0 ? void 0 : data.length) > 0) {\n    try {\n      return parser.parse(data);\n    } catch (error) {\n      throw new Error('Failed to parse XML response.');\n    }\n  }\n  return {};\n};\nexport { parseXmlBody, parseXmlError };","map":{"version":3,"names":["parseXmlError","response","_ref","_body$message","statusCode","body","parseXmlBody","code","Code","toString","message","Message","error","Error","Object","assign","name","$metadata","parseMetadata","data","text","length","parser","parse"],"sources":["/Users/raphaperso/Documents/Hub/amplify_test/notes/node_modules/@aws-amplify/storage/src/providers/s3/utils/client/utils/parsePayload.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { parseMetadata, } from '@aws-amplify/core/internals/aws-client-utils';\nimport { parser } from '../runtime';\nexport const parseXmlError = async (response) => {\n    if (!response || response.statusCode < 300) {\n        return;\n    }\n    const { statusCode } = response;\n    const body = await parseXmlBody(response);\n    const code = body?.Code\n        ? body.Code\n        : statusCode === 404\n            ? 'NotFound'\n            : statusCode.toString();\n    const message = body?.message ?? body?.Message ?? code;\n    const error = new Error(message);\n    return Object.assign(error, {\n        name: code,\n        $metadata: parseMetadata(response),\n    });\n};\nexport const parseXmlBody = async (response) => {\n    if (!response.body) {\n        // S3 can return 200 without a body indicating failure.\n        throw new Error('S3 aborted request.');\n    }\n    const data = await response.body.text();\n    if (data?.length > 0) {\n        try {\n            return parser.parse(data);\n        }\n        catch (error) {\n            throw new Error('Failed to parse XML response.');\n        }\n    }\n    return {};\n};\n"],"mappings":";;;;;;AAAA;AACA;AAGY,MAACA,aAAa,GAAG,MAAOC,QAAQ,IAAK;EAAA,IAAAC,IAAA,EAAAC,aAAA;EAC7C,IAAI,CAACF,QAAQ,IAAIA,QAAQ,CAACG,UAAU,GAAG,GAAG,EAAE;IACxC;EACR;EACI,MAAM;IAAEA;EAAU,CAAE,GAAGH,QAAQ;EAC/B,MAAMI,IAAI,GAAG,MAAMC,YAAY,CAACL,QAAQ,CAAC;EACzC,MAAMM,IAAI,GAAGF,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEG,IAAI,GACjBH,IAAI,CAACG,IAAI,GACTJ,UAAU,KAAK,GAAG,GACd,UAAU,GACVA,UAAU,CAACK,QAAQ,EAAE;EAC/B,MAAMC,OAAO,IAAAR,IAAA,IAAAC,aAAA,GAAGE,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEK,OAAO,cAAAP,aAAA,cAAAA,aAAA,GAAIE,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEM,OAAO,cAAAT,IAAA,cAAAA,IAAA,GAAIK,IAAI;EACtD,MAAMK,KAAK,GAAG,IAAIC,KAAK,CAACH,OAAO,CAAC;EAChC,OAAOI,MAAM,CAACC,MAAM,CAACH,KAAK,EAAE;IACxBI,IAAI,EAAET,IAAI;IACVU,SAAS,EAAEC,aAAa,CAACjB,QAAQ;EACzC,CAAK,CAAC;AACN;AACY,MAACK,YAAY,GAAG,MAAOL,QAAQ,IAAK;EAC5C,IAAI,CAACA,QAAQ,CAACI,IAAI,EAAE;IACxB;IACQ,MAAM,IAAIQ,KAAK,CAAC,qBAAqB,CAAC;EAC9C;EACI,MAAMM,IAAI,GAAG,MAAMlB,QAAQ,CAACI,IAAI,CAACe,IAAI,EAAE;EACvC,IAAI,CAAAD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEE,MAAM,IAAG,CAAC,EAAE;IAClB,IAAI;MACA,OAAOC,MAAM,CAACC,KAAK,CAACJ,IAAI,CAAC;IACrC,CAAS,CACD,OAAOP,KAAK,EAAE;MACV,MAAM,IAAIC,KAAK,CAAC,+BAA+B,CAAC;IAC5D;EACA;EACI,OAAO,EAAE;AACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}