{"ast":null,"code":"import { parse, print, GraphQLError } from 'graphql';\nimport { catchError } from 'rxjs';\nimport { ConsoleLogger } from '@aws-amplify/core';\nimport { AmplifyUrl, getAmplifyUserAgent } from '@aws-amplify/core/internals/utils';\nimport { GraphQLAuthError } from '../types/index.mjs';\nimport { isCancelError } from '@aws-amplify/api-rest';\nimport { post, cancel, updateRequestToBeCancellable } from '@aws-amplify/api-rest/internals';\nimport { AWSAppSyncRealTimeProvider } from '../Providers/AWSAppSyncRealTimeProvider/index.mjs';\nimport { resolveConfig } from '../utils/resolveConfig.mjs';\nimport { resolveLibraryOptions } from '../utils/resolveLibraryOptions.mjs';\nimport { repackageUnauthError } from '../utils/errors/repackageAuthError.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst USER_AGENT_HEADER = 'x-amz-user-agent';\nnew ConsoleLogger('GraphQLAPI');\nconst isAmplifyInstance = amplify => {\n  return typeof amplify !== 'function';\n};\n/**\n * Export Cloud Logic APIs\n */\nclass InternalGraphQLAPIClass {\n  constructor() {\n    /**\n     * @private\n     */\n    this.appSyncRealTime = new AWSAppSyncRealTimeProvider();\n    this._api = {\n      post,\n      cancelREST: cancel,\n      isCancelErrorREST: isCancelError,\n      updateRequestToBeCancellable\n    };\n  }\n  getModuleName() {\n    return 'InternalGraphQLAPI';\n  }\n  async _headerBasedAuth(amplify, authMode) {\n    let additionalHeaders = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    const {\n      region: region,\n      endpoint: appSyncGraphqlEndpoint,\n      apiKey\n    } = resolveConfig(amplify);\n    let headers = {};\n    switch (authMode) {\n      case 'apiKey':\n        if (!apiKey) {\n          throw new Error(GraphQLAuthError.NO_API_KEY);\n        }\n        headers = {\n          'X-Api-Key': apiKey\n        };\n        break;\n      case 'iam':\n        const session = await amplify.Auth.fetchAuthSession();\n        if (session.credentials === undefined) {\n          throw new Error(GraphQLAuthError.NO_CREDENTIALS);\n        }\n        break;\n      case 'oidc':\n      case 'userPool':\n        try {\n          var _await$amplify$Auth$f;\n          let token;\n          token = (_await$amplify$Auth$f = (await amplify.Auth.fetchAuthSession()).tokens) === null || _await$amplify$Auth$f === void 0 ? void 0 : _await$amplify$Auth$f.accessToken.toString();\n          if (!token) {\n            throw new Error(GraphQLAuthError.NO_FEDERATED_JWT);\n          }\n          headers = {\n            Authorization: token\n          };\n        } catch (e) {\n          throw new Error(GraphQLAuthError.NO_CURRENT_USER);\n        }\n        break;\n      case 'lambda':\n        if (typeof additionalHeaders === 'object' && !additionalHeaders.Authorization) {\n          throw new Error(GraphQLAuthError.NO_AUTH_TOKEN);\n        }\n        headers = {\n          Authorization: additionalHeaders.Authorization\n        };\n        break;\n    }\n    return headers;\n  }\n  /**\n   * to get the operation type\n   * @param operation\n   */\n  getGraphqlOperationType(operation) {\n    const doc = parse(operation);\n    const definitions = doc.definitions;\n    const [{\n      operation: operationType\n    }] = definitions;\n    return operationType;\n  }\n  /**\n   * Executes a GraphQL operation\n   *\n   * @param options - GraphQL Options\n   * @param [additionalHeaders] - headers to merge in after any `libraryConfigHeaders` set in the config\n   * @returns An Observable if the query is a subscription query, else a promise of the graphql result.\n   */\n  graphql(amplify, _ref, additionalHeaders, customUserAgentDetails) {\n    let {\n      query: paramQuery,\n      variables = {},\n      authMode,\n      authToken\n    } = _ref;\n    const query = typeof paramQuery === 'string' ? parse(paramQuery) : parse(print(paramQuery));\n    const [operationDef = {}] = query.definitions.filter(def => def.kind === 'OperationDefinition');\n    const {\n      operation: operationType\n    } = operationDef;\n    const headers = additionalHeaders || {};\n    switch (operationType) {\n      case 'query':\n      case 'mutation':\n        const abortController = new AbortController();\n        let responsePromise;\n        if (isAmplifyInstance(amplify)) {\n          responsePromise = this._graphql(amplify, {\n            query,\n            variables,\n            authMode\n          }, headers, abortController, customUserAgentDetails, authToken);\n        } else {\n          // NOTE: this wrapper function must be await-able so the Amplify server context manager can\n          // destroy the context only after it completes\n          const wrapper = async amplifyInstance => {\n            const result = await this._graphql(amplifyInstance, {\n              query,\n              variables,\n              authMode\n            }, headers, abortController, customUserAgentDetails, authToken);\n            return result;\n          };\n          responsePromise = amplify(wrapper);\n        }\n        this._api.updateRequestToBeCancellable(responsePromise, abortController);\n        return responsePromise;\n      case 'subscription':\n        return this._graphqlSubscribe(amplify, {\n          query,\n          variables,\n          authMode\n        }, headers, customUserAgentDetails, authToken);\n      default:\n        throw new Error(\"invalid operation type: \".concat(operationType));\n    }\n  }\n  async _graphql(amplify, _ref2) {\n    let {\n      query,\n      variables,\n      authMode: explicitAuthMode\n    } = _ref2;\n    let additionalHeaders = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let abortController = arguments.length > 3 ? arguments[3] : undefined;\n    let customUserAgentDetails = arguments.length > 4 ? arguments[4] : undefined;\n    let authToken = arguments.length > 5 ? arguments[5] : undefined;\n    const {\n      region: region,\n      endpoint: appSyncGraphqlEndpoint,\n      customEndpoint,\n      customEndpointRegion,\n      defaultAuthMode\n    } = resolveConfig(amplify);\n    const authMode = explicitAuthMode || defaultAuthMode || 'iam';\n    /**\n     * Retrieve library options from Amplify configuration.\n     * `customHeaders` here are from the Amplify configuration options,\n     * and are for non-AppSync endpoints only. These are *not* the same as\n     * `additionalHeaders`, which are custom headers that are either 1)\n     * included when configuring the API client or 2) passed along with\n     * individual requests.\n     */\n    const {\n      headers: customHeaders,\n      withCredentials\n    } = resolveLibraryOptions(amplify);\n    /**\n     * Client or request-specific custom headers that may or may not be\n     * returned by a function:\n     */\n    let additionalCustomHeaders;\n    if (typeof additionalHeaders === 'function') {\n      const requestOptions = {\n        method: 'POST',\n        url: new AmplifyUrl(customEndpoint || appSyncGraphqlEndpoint || '').toString(),\n        queryString: print(query)\n      };\n      additionalCustomHeaders = await additionalHeaders(requestOptions);\n    } else {\n      additionalCustomHeaders = additionalHeaders;\n    }\n    // if an authorization header is set, have the explicit authToken take precedence\n    if (authToken) {\n      additionalCustomHeaders = {\n        ...additionalCustomHeaders,\n        Authorization: authToken\n      };\n    }\n    // TODO: Figure what we need to do to remove `!`'s.\n    const headers = {\n      ...(!customEndpoint && (await this._headerBasedAuth(amplify, authMode, additionalCustomHeaders))),\n      /**\n       * Custom endpoint headers.\n       * If there is both a custom endpoint and custom region present, we get the headers.\n       * If there is a custom endpoint but no region, we return an empty object.\n       * If neither are present, we return an empty object.\n       */\n      ...(customEndpoint && (customEndpointRegion ? await this._headerBasedAuth(amplify, authMode, additionalCustomHeaders) : {}) || {}),\n      // Custom headers included in Amplify configuration options:\n      ...(customHeaders && (await customHeaders({\n        query: print(query),\n        variables\n      }))),\n      // Custom headers from individual requests or API client configuration:\n      ...additionalCustomHeaders,\n      // User agent headers:\n      ...(!customEndpoint && {\n        [USER_AGENT_HEADER]: getAmplifyUserAgent(customUserAgentDetails)\n      })\n    };\n    const body = {\n      query: print(query),\n      variables: variables || null\n    };\n    let signingServiceInfo;\n    /**\n     * We do not send the signing service info to the REST API under the\n     * following conditions (i.e. it will not sign the request):\n     *   - there is a custom endpoint but no region\n     *   - the auth mode is `none`, or `apiKey`\n     *   - the auth mode is a type other than the types listed below\n     */\n    if (customEndpoint && !customEndpointRegion || authMode !== 'oidc' && authMode !== 'userPool' && authMode !== 'iam' && authMode !== 'lambda') {\n      signingServiceInfo = undefined;\n    } else {\n      signingServiceInfo = {\n        service: !customEndpointRegion ? 'appsync' : 'execute-api',\n        region: !customEndpointRegion ? region : customEndpointRegion\n      };\n    }\n    const endpoint = customEndpoint || appSyncGraphqlEndpoint;\n    if (!endpoint) {\n      const error = new GraphQLError('No graphql endpoint provided.');\n      throw {\n        data: {},\n        errors: [error]\n      };\n    }\n    let response;\n    try {\n      const {\n        body: responseBody\n      } = await this._api.post(amplify, {\n        url: new AmplifyUrl(endpoint),\n        options: {\n          headers,\n          body,\n          signingServiceInfo,\n          withCredentials\n        },\n        abortController\n      });\n      const result = await responseBody.json();\n      response = result;\n    } catch (err) {\n      // If the exception is because user intentionally\n      // cancelled the request, do not modify the exception\n      // so that clients can identify the exception correctly.\n      if (this.isCancelError(err)) {\n        throw err;\n      }\n      response = {\n        data: {},\n        errors: [new GraphQLError(err.message, null, null, null, null, err)]\n      };\n    }\n    const {\n      errors\n    } = response;\n    if (errors && errors.length) {\n      throw repackageUnauthError(response);\n    }\n    return response;\n  }\n  /**\n   * Checks to see if an error thrown is from an api request cancellation\n   * @param {any} error - Any error\n   * @return {boolean} - A boolean indicating if the error was from an api request cancellation\n   */\n  isCancelError(error) {\n    return this._api.isCancelErrorREST(error);\n  }\n  /**\n   * Cancels an inflight request. Only applicable for graphql queries and mutations\n   * @param {any} request - request to cancel\n   * @returns - A boolean indicating if the request was cancelled\n   */\n  cancel(request, message) {\n    return this._api.cancelREST(request, message);\n  }\n  _graphqlSubscribe(amplify, _ref3) {\n    let {\n      query,\n      variables,\n      authMode\n    } = _ref3;\n    let additionalHeaders = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let customUserAgentDetails = arguments.length > 3 ? arguments[3] : undefined;\n    let authToken = arguments.length > 4 ? arguments[4] : undefined;\n    const config = resolveConfig(amplify);\n    /**\n     * Retrieve library options from Amplify configuration.\n     * `libraryConfigHeaders` are from the Amplify configuration options,\n     * and will not be overwritten by other custom headers. These are *not*\n     * the same as `additionalHeaders`, which are custom headers that are\n     * either 1)included when configuring the API client or 2) passed along\n     * with individual requests.\n     */\n    const {\n      headers: libraryConfigHeaders\n    } = resolveLibraryOptions(amplify);\n    return this.appSyncRealTime.subscribe({\n      query: print(query),\n      variables,\n      appSyncGraphqlEndpoint: config === null || config === void 0 ? void 0 : config.endpoint,\n      region: config === null || config === void 0 ? void 0 : config.region,\n      authenticationType: authMode || (config === null || config === void 0 ? void 0 : config.defaultAuthMode),\n      apiKey: config === null || config === void 0 ? void 0 : config.apiKey,\n      additionalHeaders,\n      authToken,\n      libraryConfigHeaders\n    }, customUserAgentDetails).pipe(catchError(e => {\n      if (e.errors) {\n        throw repackageUnauthError(e);\n      }\n      throw e;\n    }));\n  }\n}\nconst InternalGraphQLAPI = new InternalGraphQLAPIClass();\nexport { InternalGraphQLAPI, InternalGraphQLAPIClass };","map":{"version":3,"names":["USER_AGENT_HEADER","ConsoleLogger","isAmplifyInstance","amplify","InternalGraphQLAPIClass","constructor","appSyncRealTime","AWSAppSyncRealTimeProvider","_api","post","cancelREST","cancel","isCancelErrorREST","isCancelError","updateRequestToBeCancellable","getModuleName","_headerBasedAuth","authMode","additionalHeaders","arguments","length","undefined","region","endpoint","appSyncGraphqlEndpoint","apiKey","resolveConfig","headers","Error","GraphQLAuthError","NO_API_KEY","session","Auth","fetchAuthSession","credentials","NO_CREDENTIALS","_await$amplify$Auth$f","token","tokens","accessToken","toString","NO_FEDERATED_JWT","Authorization","e","NO_CURRENT_USER","NO_AUTH_TOKEN","getGraphqlOperationType","operation","doc","parse","definitions","operationType","graphql","_ref","customUserAgentDetails","query","paramQuery","variables","authToken","print","operationDef","filter","def","kind","abortController","AbortController","responsePromise","_graphql","wrapper","amplifyInstance","result","_graphqlSubscribe","concat","_ref2","explicitAuthMode","customEndpoint","customEndpointRegion","defaultAuthMode","customHeaders","withCredentials","resolveLibraryOptions","additionalCustomHeaders","requestOptions","method","url","AmplifyUrl","queryString","getAmplifyUserAgent","body","signingServiceInfo","service","error","GraphQLError","data","errors","response","responseBody","options","json","err","message","repackageUnauthError","request","_ref3","config","libraryConfigHeaders","subscribe","authenticationType","pipe","catchError","InternalGraphQLAPI"],"sources":["/Users/raphaperso/Documents/Hub/amplify_test/notes/node_modules/@aws-amplify/api-graphql/src/internals/InternalGraphQLAPI.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { print, parse, GraphQLError, } from 'graphql';\nimport { catchError } from 'rxjs';\nimport { ConsoleLogger } from '@aws-amplify/core';\nimport { getAmplifyUserAgent, AmplifyUrl, } from '@aws-amplify/core/internals/utils';\nimport { GraphQLAuthError, } from '../types';\nimport { isCancelError as isCancelErrorREST } from '@aws-amplify/api-rest';\nimport { post, cancel as cancelREST, updateRequestToBeCancellable, } from '@aws-amplify/api-rest/internals';\nimport { AWSAppSyncRealTimeProvider } from '../Providers/AWSAppSyncRealTimeProvider';\nimport { resolveConfig, resolveLibraryOptions } from '../utils';\nimport { repackageUnauthError } from '../utils/errors/repackageAuthError';\nconst USER_AGENT_HEADER = 'x-amz-user-agent';\nconst logger = new ConsoleLogger('GraphQLAPI');\nconst isAmplifyInstance = (amplify) => {\n    return typeof amplify !== 'function';\n};\n/**\n * Export Cloud Logic APIs\n */\nexport class InternalGraphQLAPIClass {\n    constructor() {\n        /**\n         * @private\n         */\n        this.appSyncRealTime = new AWSAppSyncRealTimeProvider();\n        this._api = {\n            post,\n            cancelREST,\n            isCancelErrorREST,\n            updateRequestToBeCancellable,\n        };\n    }\n    getModuleName() {\n        return 'InternalGraphQLAPI';\n    }\n    async _headerBasedAuth(amplify, authMode, additionalHeaders = {}) {\n        const { region: region, endpoint: appSyncGraphqlEndpoint, apiKey, } = resolveConfig(amplify);\n        let headers = {};\n        switch (authMode) {\n            case 'apiKey':\n                if (!apiKey) {\n                    throw new Error(GraphQLAuthError.NO_API_KEY);\n                }\n                headers = {\n                    'X-Api-Key': apiKey,\n                };\n                break;\n            case 'iam':\n                const session = await amplify.Auth.fetchAuthSession();\n                if (session.credentials === undefined) {\n                    throw new Error(GraphQLAuthError.NO_CREDENTIALS);\n                }\n                break;\n            case 'oidc':\n            case 'userPool':\n                try {\n                    let token;\n                    token = (await amplify.Auth.fetchAuthSession()).tokens?.accessToken.toString();\n                    if (!token) {\n                        throw new Error(GraphQLAuthError.NO_FEDERATED_JWT);\n                    }\n                    headers = {\n                        Authorization: token,\n                    };\n                }\n                catch (e) {\n                    throw new Error(GraphQLAuthError.NO_CURRENT_USER);\n                }\n                break;\n            case 'lambda':\n                if (typeof additionalHeaders === 'object' &&\n                    !additionalHeaders.Authorization) {\n                    throw new Error(GraphQLAuthError.NO_AUTH_TOKEN);\n                }\n                headers = {\n                    Authorization: additionalHeaders.Authorization,\n                };\n                break;\n            case 'none':\n                break;\n            default:\n                break;\n        }\n        return headers;\n    }\n    /**\n     * to get the operation type\n     * @param operation\n     */\n    getGraphqlOperationType(operation) {\n        const doc = parse(operation);\n        const definitions = doc.definitions;\n        const [{ operation: operationType }] = definitions;\n        return operationType;\n    }\n    /**\n     * Executes a GraphQL operation\n     *\n     * @param options - GraphQL Options\n     * @param [additionalHeaders] - headers to merge in after any `libraryConfigHeaders` set in the config\n     * @returns An Observable if the query is a subscription query, else a promise of the graphql result.\n     */\n    graphql(amplify, { query: paramQuery, variables = {}, authMode, authToken }, additionalHeaders, customUserAgentDetails) {\n        const query = typeof paramQuery === 'string'\n            ? parse(paramQuery)\n            : parse(print(paramQuery));\n        const [operationDef = {}] = query.definitions.filter(def => def.kind === 'OperationDefinition');\n        const { operation: operationType } = operationDef;\n        const headers = additionalHeaders || {};\n        switch (operationType) {\n            case 'query':\n            case 'mutation':\n                const abortController = new AbortController();\n                let responsePromise;\n                if (isAmplifyInstance(amplify)) {\n                    responsePromise = this._graphql(amplify, { query, variables, authMode }, headers, abortController, customUserAgentDetails, authToken);\n                }\n                else {\n                    // NOTE: this wrapper function must be await-able so the Amplify server context manager can\n                    // destroy the context only after it completes\n                    const wrapper = async (amplifyInstance) => {\n                        const result = await this._graphql(amplifyInstance, { query, variables, authMode }, headers, abortController, customUserAgentDetails, authToken);\n                        return result;\n                    };\n                    responsePromise = amplify(wrapper);\n                }\n                this._api.updateRequestToBeCancellable(responsePromise, abortController);\n                return responsePromise;\n            case 'subscription':\n                return this._graphqlSubscribe(amplify, { query, variables, authMode }, headers, customUserAgentDetails, authToken);\n            default:\n                throw new Error(`invalid operation type: ${operationType}`);\n        }\n    }\n    async _graphql(amplify, { query, variables, authMode: explicitAuthMode }, additionalHeaders = {}, abortController, customUserAgentDetails, authToken) {\n        const { region: region, endpoint: appSyncGraphqlEndpoint, customEndpoint, customEndpointRegion, defaultAuthMode, } = resolveConfig(amplify);\n        const authMode = explicitAuthMode || defaultAuthMode || 'iam';\n        /**\n         * Retrieve library options from Amplify configuration.\n         * `customHeaders` here are from the Amplify configuration options,\n         * and are for non-AppSync endpoints only. These are *not* the same as\n         * `additionalHeaders`, which are custom headers that are either 1)\n         * included when configuring the API client or 2) passed along with\n         * individual requests.\n         */\n        const { headers: customHeaders, withCredentials } = resolveLibraryOptions(amplify);\n        /**\n         * Client or request-specific custom headers that may or may not be\n         * returned by a function:\n         */\n        let additionalCustomHeaders;\n        if (typeof additionalHeaders === 'function') {\n            const requestOptions = {\n                method: 'POST',\n                url: new AmplifyUrl(customEndpoint || appSyncGraphqlEndpoint || '').toString(),\n                queryString: print(query),\n            };\n            additionalCustomHeaders = await additionalHeaders(requestOptions);\n        }\n        else {\n            additionalCustomHeaders = additionalHeaders;\n        }\n        // if an authorization header is set, have the explicit authToken take precedence\n        if (authToken) {\n            additionalCustomHeaders = {\n                ...additionalCustomHeaders,\n                Authorization: authToken,\n            };\n        }\n        // TODO: Figure what we need to do to remove `!`'s.\n        const headers = {\n            ...(!customEndpoint &&\n                (await this._headerBasedAuth(amplify, authMode, additionalCustomHeaders))),\n            /**\n             * Custom endpoint headers.\n             * If there is both a custom endpoint and custom region present, we get the headers.\n             * If there is a custom endpoint but no region, we return an empty object.\n             * If neither are present, we return an empty object.\n             */\n            ...((customEndpoint &&\n                (customEndpointRegion\n                    ? await this._headerBasedAuth(amplify, authMode, additionalCustomHeaders)\n                    : {})) ||\n                {}),\n            // Custom headers included in Amplify configuration options:\n            ...(customHeaders &&\n                (await customHeaders({\n                    query: print(query),\n                    variables,\n                }))),\n            // Custom headers from individual requests or API client configuration:\n            ...additionalCustomHeaders,\n            // User agent headers:\n            ...(!customEndpoint && {\n                [USER_AGENT_HEADER]: getAmplifyUserAgent(customUserAgentDetails),\n            }),\n        };\n        const body = {\n            query: print(query),\n            variables: variables || null,\n        };\n        let signingServiceInfo;\n        /**\n         * We do not send the signing service info to the REST API under the\n         * following conditions (i.e. it will not sign the request):\n         *   - there is a custom endpoint but no region\n         *   - the auth mode is `none`, or `apiKey`\n         *   - the auth mode is a type other than the types listed below\n         */\n        if ((customEndpoint && !customEndpointRegion) ||\n            (authMode !== 'oidc' &&\n                authMode !== 'userPool' &&\n                authMode !== 'iam' &&\n                authMode !== 'lambda')) {\n            signingServiceInfo = undefined;\n        }\n        else {\n            signingServiceInfo = {\n                service: !customEndpointRegion ? 'appsync' : 'execute-api',\n                region: !customEndpointRegion ? region : customEndpointRegion,\n            };\n        }\n        const endpoint = customEndpoint || appSyncGraphqlEndpoint;\n        if (!endpoint) {\n            const error = new GraphQLError('No graphql endpoint provided.');\n            throw {\n                data: {},\n                errors: [error],\n            };\n        }\n        let response;\n        try {\n            const { body: responseBody } = await this._api.post(amplify, {\n                url: new AmplifyUrl(endpoint),\n                options: {\n                    headers,\n                    body,\n                    signingServiceInfo,\n                    withCredentials,\n                },\n                abortController,\n            });\n            const result = await responseBody.json();\n            response = result;\n        }\n        catch (err) {\n            // If the exception is because user intentionally\n            // cancelled the request, do not modify the exception\n            // so that clients can identify the exception correctly.\n            if (this.isCancelError(err)) {\n                throw err;\n            }\n            response = {\n                data: {},\n                errors: [\n                    new GraphQLError(err.message, null, null, null, null, err),\n                ],\n            };\n        }\n        const { errors } = response;\n        if (errors && errors.length) {\n            throw repackageUnauthError(response);\n        }\n        return response;\n    }\n    /**\n     * Checks to see if an error thrown is from an api request cancellation\n     * @param {any} error - Any error\n     * @return {boolean} - A boolean indicating if the error was from an api request cancellation\n     */\n    isCancelError(error) {\n        return this._api.isCancelErrorREST(error);\n    }\n    /**\n     * Cancels an inflight request. Only applicable for graphql queries and mutations\n     * @param {any} request - request to cancel\n     * @returns - A boolean indicating if the request was cancelled\n     */\n    cancel(request, message) {\n        return this._api.cancelREST(request, message);\n    }\n    _graphqlSubscribe(amplify, { query, variables, authMode }, additionalHeaders = {}, customUserAgentDetails, authToken) {\n        const config = resolveConfig(amplify);\n        /**\n         * Retrieve library options from Amplify configuration.\n         * `libraryConfigHeaders` are from the Amplify configuration options,\n         * and will not be overwritten by other custom headers. These are *not*\n         * the same as `additionalHeaders`, which are custom headers that are\n         * either 1)included when configuring the API client or 2) passed along\n         * with individual requests.\n         */\n        const { headers: libraryConfigHeaders } = resolveLibraryOptions(amplify);\n        return this.appSyncRealTime\n            .subscribe({\n            query: print(query),\n            variables,\n            appSyncGraphqlEndpoint: config?.endpoint,\n            region: config?.region,\n            authenticationType: authMode || config?.defaultAuthMode,\n            apiKey: config?.apiKey,\n            additionalHeaders,\n            authToken,\n            libraryConfigHeaders,\n        }, customUserAgentDetails)\n            .pipe(catchError(e => {\n            if (e.errors) {\n                throw repackageUnauthError(e);\n            }\n            throw e;\n        }));\n    }\n}\nexport const InternalGraphQLAPI = new InternalGraphQLAPIClass();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}